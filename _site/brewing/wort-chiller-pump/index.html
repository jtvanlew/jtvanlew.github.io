<!doctype html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8">
<title>WORT CHILLER PUMP &#8211; JON</title>
<meta name="description" content="Big edit: After sharing this I had the sudden panic that I forgot to mention the gigantic assumption that I&#8217;m only looking at the sensible heat of the system, which is why I can treat the energy equations in terms of temperature (and not, say, enthalpy). That assumption makes the equations tractable but also puts a fairly significant limit to the applicaption of the results. Namely if ice were in the cold bath (which is quite common), the latent heat of melting would keep the cold bath cold for much longer than this analysis would otherwise predict. Anyway, this analysis was done for the sake of curiosity so its results stand as they do.

">
<meta name="keywords" content="wort chiller, homebrewing, engineering">

<!-- Twitter Cards -->
<meta name="twitter:title" content="Wort chiller pump">
<meta name="twitter:description" content="Big edit: After sharing this I had the sudden panic that I forgot to mention the gigantic assumption that I&#8217;m only looking at the sensible heat of the system, which is why I can treat the energy equations in terms of temperature (and not, say, enthalpy). That assumption makes the equations tractable but also puts a fairly significant limit to the applicaption of the results. Namely if ice were in the cold bath (which is quite common), the latent heat of melting would keep the cold bath cold for much longer than this analysis would otherwise predict. Anyway, this analysis was done for the sake of curiosity so its results stand as they do.

">
<meta name="twitter:site" content="@jtvanlew">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/Molly_Small.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Wort chiller pump">
<meta property="og:description" content="Big edit: After sharing this I had the sudden panic that I forgot to mention the gigantic assumption that I&#8217;m only looking at the sensible heat of the system, which is why I can treat the energy equations in terms of temperature (and not, say, enthalpy). That assumption makes the equations tractable but also puts a fairly significant limit to the applicaption of the results. Namely if ice were in the cold bath (which is quite common), the latent heat of melting would keep the cold bath cold for much longer than this analysis would otherwise predict. Anyway, this analysis was done for the sake of curiosity so its results stand as they do.

">
<meta property="og:url" content="/brewing/wort-chiller-pump">
<meta property="og:site_name" content="Jon">






<link rel="canonical" href="/brewing/wort-chiller-pump">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Jon Feed">
<link rel="author" href="http://plus.google.com/https://plus.google.com/+JonVanLew/?rel=author">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Webfonts -->
<link href='http://fonts.googleapis.com/css?family=Vollkorn:400,700&amp;subset=latin,latin-ext' rel='stylesheet'>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300,700,800,600&amp;subset=latin,latin-ext' rel='stylesheet'>
<link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:400,700' rel='stylesheet'>
<link href='http://fonts.googleapis.com/css?family=Pathway+Gothic+One' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
<link rel="stylesheet" href="/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/assets/css/style.css">
<link rel="stylesheet" href="/assets/css/post.css">
<link rel="stylesheet" href="/assets/css/post-cover.css">
<link rel="stylesheet" href="/assets/css/additional.css">


<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>/*<![CDATA[*/window.jQuery||document.write('<script src="/assets/js/vendor/jquery-1.11.1.min.js"><\/script>');/*]]>*/</script>





<!-- Ammap scripts -->
<script src="/assets/js/vendor/ammap.js" type="text/javascript"></script>
<script src="/assets/js/vendor/worldLow.js" type="text/javascript"></script>
<script src="/assets/js/vendor/usaLow.js" type="text/javascript"></script>
<!--/Ammap scripts -->




<script type="text/javascript" src="/assets/js/vendor/amcharts.js"></script>





<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>MathJax.Hub.Config({config:["MMLorHTML.js"],extensions:["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],jax:["input/TeX"],tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:false},TeX:{TagSide:"right",TagIndent:".8em",MultLineWidth:"85%",equationNumbers:{autoNumber:"AMS",},unicode:{fonts:"STIXGeneral,'Arial Unicode MS'"}},showProcessingMessages:false});</script>
<!-- Battle For the Net -->
<script type="text/javascript">
    var _bftn_options = {
      animation: 'banner',
      position: 'bottomright',
      theme: 'dark'
    }
</script>
<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/icons/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/icons/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/icons/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/icons/apple-touch-icon-144x144-precomposed.png">
</head>

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float: left; font-size: 4.875rem; line-height: 3.750rem; padding-top: 0.375rem; padding-right: 0.375rem; font-family:serif}}</style>
<body class="post-template">
    <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
        <header class="notepad-post-header-simple">
            <div class="notepad-post-menu-header-simple">
                
                <a class="notepad-blog-logo" href=""><img src="/images/elements/Molly_Small.png" alt="Blog Logo" /></a>


        <div class="notepad-blog-menu">      
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>
        <li>
            <a href="/">Home</a>
        </li><li>
            <a href="/categories">Categories</a>
        </li><li>
            <a href="/about">About</a>
        </li><li>
            <a href="/photos/maps/">Travel Photos</a>
        </li><li>
            <a href="/page/xively-temp/">Work</a>
        </li>
        <!-- <li><a href="/feed.xml" title="Atom/RSS feed">Feed</a></li> -->
    </ul>
</div>
 <div class="clearfix"></div>
            </div>
            <div class="notepad-post-title-simple row">
                <div class="small-12 columns">
                    <div class="notepad-post-meta-simple">
                        <h1>Wort chiller pump</h1>
                        <p class="meta">by <strong><a href="/author/Jon Van Lew">Jon Van Lew</a></strong> &#8212; <span class="simple-view-tag-list"><span class="tags-loop"><span class="tag-prefix">on</span> <span class="tag-link"> <a href="/tags/index.html#wort chiller" title="Posts tagged with wort chiller">wort chiller</a> </span><span class="tag-link"> <a href="/tags/index.html#homebrewing" title="Posts tagged with homebrewing">homebrewing</a> </span><span class="tag-link"> <a href="/tags/index.html#engineering" title="Posts tagged with engineering">engineering</a> </span></span></span><strong><time datetime="2014-12-06T00:00:00-08:00">06 Dec 2014</time></strong>
</p>
<p><strong><i>&quot;and the art of over-engineering&quot;</i></strong></p></p>
                    </div>
                </div>
            </div>
        </header>
    </main>
    <article class="notepad-post-content post">
        <div>
            <div class="paddings">
                <p>Big edit: After sharing this I had the sudden panic that I forgot to mention the gigantic assumption that <strong>I’m only looking at the sensible heat of the system</strong>, which is why I can treat the energy equations in terms of temperature (and not, say, enthalpy). That assumption makes the equations tractable but also puts a fairly significant limit to the applicaption of the results. Namely if ice were in the cold bath (which is quite common), the latent heat of melting would keep the cold bath cold for much longer than this analysis would otherwise predict. Anyway, this analysis was done for the sake of curiosity so its results stand as they do.</p>

<p>At the new apartment, my brewing has gone outdoors to the back patio. The patio drains off onto the cars parked below the patio, so running an open loop of water through my wort chiller isn’t an option anymore. Not even to mention the ethics of dumping gallons of water during a drought.</p>

<p>I went looking around for a submersible aquarium pump to run a closed-loop water cycle in a cooler – like the one shown in this image i jacked from some dude on flickr…</p>

<p><img src="/images/post/2115697301_ff9c9a3de1.jpg" alt="wort chiller pumping" /></p>

<p>Of course I became curious about solving the energy balance for the temperatures of the wort as a function of time. It becomes interesting when you consider that the cold water flushes through the hot wort, and then warms up the cold bath as it dumps back into the reservoir. The curiosity is mostly academic and not really influencing a design as I see it. But … here goes.</p>

<h1 id="equations">Equations</h1>
<p>In a really simplified sense, the hot wort and cold bath can be treated as coupled isothermal baths with one inlet/outlet of fluid. A schematic of the exchange is here:</p>

<p><img src="/images/post/wort_chiller.png" alt="wort chiller schematic" /></p>

<p>For this problem the cold fluid is all at $T_c$ whether its in the bath or in the transfer line. Same goes for the hot wort and hot end of the transfer line. Doing any open, transient energy balance on the two baths yields the simple coupled system of ODEs:</p>

<script type="math/tex; mode=display">
\begin{equation}
m_b \cfrac{\mathrm{d}T_b}{\mathrm{dt}} = \dot{m}(T_c-T_b)\\\
m_c \cfrac{\mathrm{d}T_c}{\mathrm{dt}} = \dot{m}(T_b-T_c)\\\
\end{equation}
</script>

<p>Obviously $\dot{m}$ is the mass flow pushed by the pump, and $m_b$ and $m_c$ are the masses of fluid sitting in the hot and cold baths, respectively. I’ll solve this by putting it into matrix form,</p>

<script type="math/tex; mode=display">% <![CDATA[

\begin{equation}
\cfrac{\mathrm{d}}{\mathrm{dt}}\begin{bmatrix}T_b\\T_c\end{bmatrix} = \begin{bmatrix}-\dot{m}/m_b & \dot{m}/m_b \\ \dot{m}/m_c & -\dot{m}/m_c\end{bmatrix}\begin{bmatrix}T_b\\T_c\end{bmatrix}
\end{equation}
 %]]></script>

<p>The vector-form of the simple ODE is solved in the same method as we would a classical first order ODE. Good detail can be found <a href="http://tutorial.math.lamar.edu/Classes/DE/SolutionsToSystems.aspx">on this site</a>. In other words, we can assume the solution is of some form (exponential) and then where the time constant in the exponential growth/decay comes from eigenvalues of the problem. For this system of equations, we find not only the eigenvalues but eigenvectors.</p>

<p>The two eigenvalues are $\lambda_1 = 0$ and $\lambda_2 = -(\dot{m}/m_b + \dot{m}/m_c)$. The corresponding eigen vectors are</p>

<script type="math/tex; mode=display">\bar{\eta}_1 = \begin{bmatrix}1\\1\end{bmatrix}</script>

<p>and </p>

<script type="math/tex; mode=display">\bar{\eta}_2 = \begin{bmatrix}1\\-m_b/m_c\end{bmatrix}</script>

<p>Thus the general solution is</p>

<script type="math/tex; mode=display">
\begin{equation}
\begin{bmatrix}T_b\\T_c\end{bmatrix} = C_1\begin{bmatrix}1 \\ 1 \end{bmatrix} + C_2 e^{-(\dot{m}/m_b + \dot{m}/m_c)t}\begin{bmatrix}1\\-m_b/m_c\end{bmatrix}
\end{equation}
</script>

<p>The initial conditions are left as just generic values for both baths. Plugging in those values at time $t=0$ to the general solution let’s us find the coefficients:</p>

<script type="math/tex; mode=display">
\begin{equation}
C_1 = T_{b,i} - \cfrac{\Delta T_i}{1+m_b/m_c}\\\
C_2 = \cfrac{T_{b,i} - T_{c,i}}{1+m_b/m_c}
\end{equation}
</script>

<p>where $\Delta T_i$ is just the difference in temperatures of the two baths at the initial condition. I’ll define the ratio of hot-cold baths as a dimensionless parameter $\alpha$. When $\alpha &lt; 1$, the hot bath is being cooled by a larger mass of cold water. Vice versa for $\alpha &gt; 1$. </p>

<p>I want to clean up the solution a little so I’ll introduce another term, $\tau$ which I’ll consider as the time constant for the system. It’ll be defined as $\tau = \frac{m_b}{\dot{m}}$ – which can be thought of as how long does it take to move one hot bath’s worth of mass through the transfer lines. Finally, the solutions, when broken out of vector form, are</p>

<script type="math/tex; mode=display">
\begin{equation}
T_b(t) = T_{b,i} - \left(\frac{\Delta T_i}{1+\alpha}\right)\left[1-e^{-(1+\alpha)t/\tau}\right] \\\
T_c(t) = T_{b,i} - \left(\frac{\Delta T_i}{1+\alpha}\right)\left[1+\alpha e^{-(1+\alpha)t/\tau}\right] 
\end{equation}
</script>

<h3 id="short-equation-discussions">Short equation discussions</h3>
<p>I’d like to actually pause to look at the solutions of the hot and cold bath temperatures. As a logic check, I want to see how the solutions look as $t\rightarrow \infty$ – or in other words, steady state. For the hot bath we’re left with </p>

<script type="math/tex; mode=display">
\begin{equation}
T_b = T_{b,i} - \frac{\Delta T_i}{1+\alpha}
\end{equation}
</script>

<p>For the simple case of when $\alpha = 1$ (aka equal sizes of hot and cold tanks), the final temperature of the hot reservoir is simply <script type="math/tex">T_b = T_{b,i}/2 + T_{c,i}/2</script> – or the average value of the initial temperatures. This is exactly what we should have expected so it’s good that it worked out.</p>

<p>I also would like to point out that this steady state temperature is not at all a function of the pump flowrate. It’s simply a mass-weighted average for temperature based on the sizes of my two tanks. The only place the flowrate does come in to play is in the exponential term – it dictates how quickly the system will reach the steady state / equilibrium.</p>

<p>Ok. With that little discussion out of the way, let’s look at some graphs…</p>

<h2 id="results">Results</h2>
<p>Background: I found a pump on Amazon that was $7 and ran at 80 gal/hr. I’ll assume that my wort is about 3 gallons. I’ll generally top off my fermenter with chilled water to hit 5 gallons so I aim for chilling the wort to only 80 F and then in the fermenter I can get pitching temperatures. These values will be used as guidlines for the computations.</p>

<p>I want to compare the temperatures of the two baths as the cold bath volume changes. Like, can 3 gal of frozen water drop 3 gal of boiling water to 80 F? (no). Or what size do I need in order to actually hit 80 F and how quickly will it reach it? The easiest way to solve this is with some simple scripting. The code is given in its entirety at the bottom. </p>

<h3 id="steady-state-final-wort-temperature">Steady state final wort temperature</h3>
<p>The first thing I want to plot are steady-state temperatures as a function of the mass-ratio, $\alpha = m_b/m_c$. </p>

<p><img src="/images/post/figure-wort-chiller-ss.png" alt="wort chiller temp plots" /></p>

<p>The shaded regions represent acceptable (blue) and unacceptable (red) mass ratios if we want to ever hit 80 F as the pitching temperature for our hot wort. The intersection of our target pitching temperature and the steady state value comes at $\alpha = 0.36$. This translates to a cold bath volume that is 2.8 times larger than the hot wort. For my example of having 3 gallons of hot wort, I’ll need 8.3 gallons of ice water when I begin to chill. That’s almost 9 gallons MINIMUM! That’s a remarkably large volume of water – considering the whole point of this was to try and conserve water during the cooling process. I think a future post will compare the total amounts of water consumed during open, closed, and mixed chilling.</p>

<h3 id="transient-hot-and-cold-temperatures-with-different-volumes">Transient hot and cold temperatures with different volumes</h3>
<p>Now that we know we need a minimum of $\alpha = 0.36$ in order to ever hit a pitching temperature, let’s see how the temperatures change in time for different $\alpha$ at a flowrate of 80 gph. </p>

<p><img src="/images/post/figure-wort-chiller-transient.png" alt="wort chiller temp plots" /></p>

<p>The upper and lower lines are the plots of hot and cold water temperatures, respectively. We see again that with $\alpha = 0.36$ we just barely will hit that 80 F target after sufficient time. With smaller volumes of cold water (larger $\alpha$), the cold bath raises up faster so the hot bath never has a chance to reach 80 F. As the cold volume increases ($\alpha &lt; 0.36$), the target temperature is hit at earlier and earlier times.</p>

<p>For the next analysis, I want to take the ratio of $\alpha = 0.25$. It looks fast enough; it takes about 4 and a half minutes to hit 80 F. It also means if I have 3 gal of wort, I’ll need 12 gallons of ice water (that’s not too much, I guess?).</p>

<h3 id="transient-hot-and-cold-with-different-flowrates">Transient hot and cold with different flowrates</h3>
<p>The next logical step is to take my chosen mass ratio and find the temperature profiles for different flowrates. </p>

<p><img src="/images/post/figure-wort-chiller-q.png" alt="wort chiller temp plots" /></p>

<p>There’s a pretty dramatic difference in time between 40 gph and 80 gph, about 9 minutes for the slowest flowrate. You begin to then get diminishing returns for higher flowrate pumps. All the way to 200 gph, the time to hit my target temperature is only reduced to about 2 minutes from 4.5 minutes. </p>

<p>I must note, though, that I haven’t thought at all about how effective the physical wort chiller is that’s sitting in the hot liquid. I suspect that at the large flow rates, my assumption that the chilling water exits at the same temperature as the average temperature of the hot bath becomes less and less valid. That faster flow rate might be completely wasted if the efficiency of the chiller isn’t able to match it. </p>

<h2 id="conclusions-kind-of">Conclusions…. kind of</h2>

<p>Now… what does any of thise have to do with buying a pump? Well, not much. The difference between an 80 gph pump and a 158 gph pump (at twice the price) would be hitting pitching temperature about a minute faster – given all the assumptions of my energy balance. Those flowrates are given by the pump description but I doubt I’d reach those values when its connected to the long copper coil of the wort chiller, and its concomitant pressure drop. Considering that I titled this “wort chiller pump” and not “wort chiller cold volume”, I think the most important thing these equations highlight is how much more dependent the results are on the cold water volume than any aspect of the pump flowrate. You’re not going to get anywhere unless your cold water volume is almost 3 times larger than hot. That’s pretty interesting.</p>

<h2 id="code">Code</h2>
<p>I wrapped up the equations in some pert little code, reproduced here for posterity</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">KtoF</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
	<span class="c"># temperature converter for Kelvin to Farenheit</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="mi">273</span><span class="p">)</span><span class="o">*</span><span class="mf">1.8</span><span class="o">+</span><span class="mi">32</span>

<span class="k">def</span> <span class="nf">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
	<span class="c"># time converter for seconds to minutes</span>
	<span class="k">return</span> <span class="n">t</span><span class="o">/</span><span class="mi">60</span>

<span class="c"># Physical properties of the system</span>
<span class="n">Qgph</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">Qgph</span> <span class="o">*</span> <span class="mf">0.00105150</span> <span class="c"># gal/hr to L/s</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1000</span>     		<span class="c"># water density </span>
<span class="n">Vb</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*.</span><span class="mo">0037</span><span class="mi">9</span>  		<span class="c"># gal to m3 hot bath</span>
<span class="n">mb</span> <span class="o">=</span> <span class="n">rho</span><span class="o">*</span><span class="n">Vb</span>  		<span class="c"># mass of the wort</span>
<span class="n">Tci</span> <span class="o">=</span> <span class="mi">273</span> 			<span class="c"># K</span>
<span class="n">Tbi</span> <span class="o">=</span> <span class="mi">373</span> 			<span class="c"># K</span>
<span class="n">DeltaTi</span> <span class="o">=</span> <span class="n">Tbi</span> <span class="o">-</span> <span class="n">Tci</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">600</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c"># timespan</span>

<span class="c"># Non-dimensional parameters</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.36</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">])</span>
<span class="n">tau</span> <span class="o">=</span> <span class="n">mb</span><span class="o">/</span><span class="n">Q</span>





<span class="c"># Analysis of steady-state~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="n">alphaArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">Tf</span> <span class="o">=</span> <span class="n">Tbi</span> <span class="o">-</span> <span class="n">DeltaTi</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alphaArray</span><span class="p">)</span> 
<span class="n">Taim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">alphaArray</span><span class="p">))</span><span class="o">+</span><span class="mi">80</span> <span class="c"># the temperature we&#39;re aiming for (as an array with time)</span>

<span class="n">TfGood</span> <span class="o">=</span> <span class="n">Tf</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Tf</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">80</span><span class="p">)]</span>
<span class="n">alphaGood</span> <span class="o">=</span> <span class="n">alphaArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Tf</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">80</span><span class="p">)]</span>
<span class="n">TfBad</span> <span class="o">=</span> <span class="n">Tf</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Tf</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span><span class="p">)]</span>
<span class="n">alphaBad</span> <span class="o">=</span> <span class="n">alphaArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Tf</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">80</span><span class="p">)]</span>
<span class="n">alphaMin</span> <span class="o">=</span> <span class="n">alphaGood</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&quot;Minimum necessary mass-ratio = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">alphaMin</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphaArray</span><span class="p">,</span> <span class="n">Taim</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;80 F target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alphaArray</span><span class="p">,</span> <span class="n">KtoF</span><span class="p">(</span><span class="n">Tf</span><span class="p">),</span> <span class="s">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Steady-state Temperature&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">alphaGood</span><span class="p">,</span> <span class="n">KtoF</span><span class="p">(</span><span class="n">TfGood</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">r&quot;Required $\alpha$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">alphaBad</span><span class="p">,</span> <span class="n">KtoF</span><span class="p">(</span><span class="n">TfBad</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">r&#39;Unacceptable $\alpha$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">r&#39;Non-dimensional mass ratio, $\alpha$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Steady-state Temperature (F)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="c"># /Analysis of steady-state~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>



<span class="c"># Analysis of transient~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="n">Taim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">+</span><span class="mi">80</span> <span class="c"># the temperature we&#39;re aiming for (as an array with time)</span>
<span class="c"># set up the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">Taim</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;80 F target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (minutes)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Temperature (F)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="c"># looping over different cold water / hot water bath volumes</span>
<span class="c"># to find the solution of temperature with time</span>
<span class="c"># reminder: alpha = m_b / m_c</span>
<span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
	<span class="n">gamma</span> <span class="o">=</span> <span class="n">DeltaTi</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">)</span> <span class="c"># intermediate calc</span>
	<span class="n">Tb</span> <span class="o">=</span> <span class="n">Tbi</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">*</span><span class="n">gamma</span>
	<span class="n">Ti</span> <span class="o">=</span> <span class="n">Tbi</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">*</span><span class="n">gamma</span>
	
	<span class="c"># plot the current temperature profiles</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Tb</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">r&#39;$\alpha$ = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Ti</span><span class="p">),</span> <span class="s">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Pump flowrate </span><span class="si">%s</span><span class="s"> gph&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">Qgph</span><span class="p">))</span>
<span class="c"># /Analysis of transient~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>


<span class="c"># Analysis of flowrate~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="c"># set up the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">Taim</span><span class="p">,</span><span class="s">&#39;k&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;80 F target&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (minutes)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;Temperature (F)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">Qgph</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>

<span class="n">alphaQ</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="c"># looping over different flowrates</span>
<span class="c"># to find the solution of temperature with time</span>
<span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">Qgph</span><span class="p">:</span>
	<span class="n">Q</span> <span class="o">=</span> <span class="n">q</span>
	<span class="n">q</span> <span class="o">=</span> <span class="n">Q</span> <span class="o">*</span> <span class="mf">0.00105150</span> <span class="c"># gal/hr to L/s</span>
	<span class="n">tau</span> <span class="o">=</span> <span class="n">mb</span><span class="o">/</span><span class="n">q</span>
	<span class="n">gamma</span> <span class="o">=</span> <span class="n">DeltaTi</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alphaQ</span><span class="p">)</span> <span class="c"># intermediate calc</span>
	<span class="n">Tb</span> <span class="o">=</span> <span class="n">Tbi</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alphaQ</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">*</span><span class="n">gamma</span>
	<span class="n">Ti</span> <span class="o">=</span> <span class="n">Tbi</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alphaQ</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">alphaQ</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">))</span><span class="o">*</span><span class="n">gamma</span>
	
	<span class="c"># plot the current temperature profiles</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Tb</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s">r&#39;flowrate = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">StoM</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">KtoF</span><span class="p">(</span><span class="n">Ti</span><span class="p">),</span> <span class="s">&#39;k--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;best&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">r&#39;Mass ratio $\alpha$ = </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">alphaQ</span><span class="p">))</span>
<span class="c"># /Analysis of flowrate~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></code></pre></div>

            </div>
        </div>
    </article>
    <div class="cf"></div>
    <div class="notepad-share-icons social-icons text-center">
        <div class="row">
            <section class="notepad-post-share">
                <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Wort chiller pump&quot;%20/brewing/wort-chiller-pump%20via%20&#64;jtvanlew" title="Share on Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
                <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=/brewing/wort-chiller-pump"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
                    <i class="fa fa-facebook"></i>
                </a>
                <a class="google-icon" href="https://plus.google.com/share?url=/brewing/wort-chiller-pump"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
                    <i class="fa fa-google-plus"></i>
                </a>
            </section>
        </div>
    </div>
<div class="cf"></div>
    <section class="notepad-disqus">
	<div class="row">
		<div class="small-12 columns">
			<h1 class="notepad-comments-header">Comments</h1>
			<div id="disqus_thread"></div>
			<script type="text/javascript">
			    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
			    var disqus_shortname = 'jonnyvlreport'; // required: replace example with your forum shortname
			
			    /* * * DON'T EDIT BELOW THIS LINE * * */
			    (function() {
			        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
			        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
			        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			    })();
			</script>
			<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
			<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
		</div>
	</div>
</section>
<div class="cf"></div>
        <div class="notepad-author-info">
            <div class="row">
                <section class="notepad-post-author small-12 columns">
                    
                        <img src="/images/avatars/jtvanlew.jpg" class="notepad-post-author-avatar" alt="Jon Van Lew">
                    
                    
                        <span class="author-label">Author</span>
                        <h1><a href="/author/Jon Van Lew" class="author-link-name">Jon Van Lew</a></h1>
                    
                    
                        <p><a href="mailto:jtvanlew@ucla.edu" class="author-email">jtvanlew@ucla.edu</a></p>
                    
                    
                        <p></p>
                    
                </section>
            </div>
        </div>
<div class="cf"></div>
<footer class="notepad-site-footer">
    <div class="copyright">
         <section>All content copyright <a href="/about">Jon Van Lew</a> &copy; 2014 &bull; All rights reserved.</section>
         <section>Proudly published with <a class="icon-ghost" href="https://jekyllrb.com/">Jekyll</a> on <a href="/update-log">Saturday, 27 Dec 2014 at 11:05 AM UTC</a></section>
    </div>
    <div class="social-icons">
        
        
        <a href="/feed.xml">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-rss fa-stack-1x"></i>
            </span>
        </a>
        
        <a href="http://twitter.com/jtvanlew" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        <a href="http://plus.google.com/https://plus.google.com/+JonVanLew/" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-google-plus fa-stack-1x"></i>
            </span>
        </a>
        
        <a href="http://instagram.com/jtvanlew" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-instagram fa-stack-1x"></i>
            </span>
        </a>
        
        <a href="http://github.com/jtvanlew" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        <a href="http://facebook.com/jtvanlew" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-facebook fa-stack-1x"></i>
            </span>
        </a>
    </div>
    
    <div class="cf"></div>
</footer>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
    <script src="/assets/js/vendor/modernizr.js"></script>
    <script src="/assets/js/foundation.min.js"></script>
    
    <script src="/assets/js/notepad.js"></script>
    <script src="/assets/js/scripts.min.js"></script>
    <script src="/assets/js/vendor/nprogress.js"></script>


    <script>
      $(document).foundation();
    </script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24714334-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

<script>NProgress.start();var interval=setInterval(function(){NProgress.inc()},1000);jQuery(window).load(function(){clearInterval(interval);NProgress.done()});jQuery(window).unload(function(){NProgress.start()});</script>

</body>
</html>